BD_2016 SQL: zad na 5
SELECT nrk, nrs, max(sr)
FROM(
SELECT s.NR_STUD as nrs,s.NR_KIER as nrk, avg(o.OCENA) as sr
FROM studenci s, oceny o, przedmioty p
WHERE s.NR_STUD=o.NR_STUD and 
p.NR_PRZEDM=o.NR_PRZEDM and
p.NAZWA_PRZEDM='BAZY DANYCH'
GROUP BY s.NR_STUD, s.NR_KIER) as t, studenci ss
WHERE nrs as 
GROUP BY nrk

V LEPSZA WEJSA TEGO V

select s.nr_stud, s.nr_kier, avg(o1.OCENA)
from oceny o1, przedmioty p, studenci s
where s.NR_STUD=o1.NR_STUD and 
o1.NR_PRZEDM=p.NR_PRZEDM and
p.NAZWA_PRZEDM = 'BAZY DANYCH'
group by s.NR_STUD, s.NR_KIER 
having avg(o1.OCENA) >= all 
	(select avg(o2.ocena)
	from oceny o2, studenci s2
	where o2.NR_STUD=s2.NR_STUD and
	s2.NR_KIER=s.NR_KIER
	GROUP BY o2.NR_STUD)


SELECT wn.NR_TEM, wn.nr_prac, sum(wn.KWOTA)
FROM wyplaty wn
GROUP BY wn.NR_TEM, wn.NR_PRAC
HAVING sum(wn.KWOTA) >= all (
	SELECT sum(w.KWOTA)
	FROM  wyplaty w
	WHERE w.nr_tem=wn.NR_TEM
	GROUP BY w.NR_PRAC)

ZADANIA Z PLATFORMY:

SELECT t.nr_tem, t.TEMAT, avg(w1.kwota)
from tematy t, wyplaty w1
where t.NR_TEM=w1.NR_TEM
group by t.NR_TEM, t.TEMAT
having avg(w1.KWOTA) > 
	(select min(w2.kwota)
	from wyplaty w2
	where w2.nr_tem=t.NR_TEM
	and w2.nr_prac IN 
		(select w3.nr_prac
		from wyplaty w3
		where w3.nr_tem=t.nr_tem
		group by w3.nr_prac
		having sum(w3.kwota) >= all
			(select sum(w4.kwota)
			from wyplaty w4
			where w4.nr_tem=t.nr_tem
			group by w4.nr_prac)))